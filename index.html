<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Blu Bul ($BUL) - Join the wild memecoin doodle adventure on the Sui blockchain with enhanced doodles!">
  <meta name="keywords" content="Blu Bul, $BUL, memecoin, cryptocurrency, Sui blockchain, NFTs, memes">
  <title>Blu Bul - $BUL</title>
  <link rel="shortcut icon" href="./main.jpg" type="image/x-icon">
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Gochi+Hand&family=Comic+Neue:wght@400;700&display=swap" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.2/p5.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <style>
    body {
      margin: 0;
      font-family: 'Gochi Hand', cursive;
      background: url('data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"%3E%3Crect width="100" height="100" fill="%23f5f5f0"/%3E%3Cpath d="M0 0l100 100M100 0L0 100" stroke="%23d9d9d4" stroke-width="0.5" opacity="0.3"/%3E%3Ccircle cx="50" cy="50" r="10" fill="none" stroke="%23a1a1a1" stroke-width="1" stroke-dasharray="3"/%3E%3C/svg%3E') repeat, #f5f5f0;
      color: #2b2b2b;
      overflow-x: hidden;
    }
    .paper-panel {
      background: #fffef0 url('data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="20" height="20"%3E%3Cpath d="M0 0h20v20H0z" fill="none"/%3E%3Cpath d="M5 5h10" stroke="%23d9d9d4" stroke-width="0.5" opacity="0.2"/%3E%3C/svg%3E') repeat;
      border: 3px solid #2b2b2b;
      border-radius: 10px;
      padding: 1.5rem;
      margin: 1rem auto;
      max-width: 1000px;
      box-shadow: 8px 8px 12px rgba(0, 0, 0, 0.2), inset 2px 2px 5px rgba(0, 0, 0, 0.05);
      position: relative;
      animation: doodle-float 3s infinite ease-in-out;
    }
    @keyframes doodle-float {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-8px); }
    }
    .paper-panel::before {
      content: '';
      position: absolute;
      top: -6px;
      left: -6px;
      right: -6px;
      bottom: -6px;
      border: 2px dashed #a1a1a1;
      border-radius: 12px;
      z-index: -1;
    }
    h1, h2, h3 {
      font-family: 'Comic Neue', cursive;
      color: #2b2b2b;
      text-shadow: 1px 1px 2px #d9d9d4;
      font-weight: 700;
      position: relative;
    }
    h1::after, h2::after {
      content: '✏️';
      position: absolute;
      right: -20px;
      top: -10px;
      font-size: 1.2rem;
      opacity: 0.6;
    }
    .doodle-img {
      border: 2px solid #2b2b2b;
      border-radius: 8px;
      padding: 5px;
      background: #fff;
      box-shadow: 4px 4px 8px rgba(0, 0, 0, 0.15);
      animation: doodle-bounce 2s infinite;
      max-width: 40%;
      height: auto;
    }
    @keyframes doodle-bounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-10px); }
    }
    .doodle-button {
      background: #ffeb3b;
      border: 2px solid #2b2b2b;
      padding: 0.6rem 1.2rem;
      border-radius: 8px;
      color: #2b2b2b;
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      font-family: 'Comic Neue', cursive;
      font-weight: 700;
      position: relative;
      transition: transform 0.2s, background 0.2s;
      cursor: pointer;
    }
    .doodle-button:disabled {
      background: #d9d9d4;
      cursor: not-allowed;
      transform: none;
    }
    .doodle-button::before {
      content: '⭐';
      position: absolute;
      top: -10px;
      left: -10px;
      font-size: 1rem;
      opacity: 0.5;
    }
    .doodle-button:hover:not(:disabled) {
      transform: scale(1.1);
      background: #ffd700;
    }
    .contract {
      background: #fff3cc;
      border: 2px dashed #2b2b2b;
      padding: 1rem;
      border-radius: 8px;
      font-size: 0.9rem;
      word-break: break-all;
      text-align: center;
      max-width: 90%;
      margin: 0 auto;
    }
    .roadmap-container {
      position: relative;
      min-height: 80vh;
      max-width: 900px;
      margin: 0 auto;
      overflow: visible;
      padding-top: 80px;
    }
    .roadmap-item {
      background: #fffef0;
      border: 3px solid #2b2b2b;
      border-radius: 12px;
      padding: 1.5rem;
      box-shadow: 6px 6px 12px rgba(0, 0, 0, 0.2);
      margin: 1.5rem auto;
      width: 90%;
      opacity: 0;
      transform: translateY(50px) scale(0.95);
      transition: opacity 0.5s ease-out, transform 0.5s ease-out;
      position: relative;
      z-index: 1;
    }
    .roadmap-item.active {
      opacity: 1;
      transform: translateY(0) scale(1);
      position: sticky;
      top: 80px;
      z-index: 10;
    }
    .roadmap-item[data-phase="1"] { transform: translateY(50px) rotate(2deg); }
    .roadmap-item[data-phase="2"] { transform: translateY(50px) rotate(-3deg); }
    .roadmap-item[data-phase="3"] { transform: translateY(50px) rotate(1deg); }
    .roadmap-item[data-phase="4"] { transform: translateY(50px) rotate(-2deg); }
    .roadmap-item.active[data-phase="1"] { transform: translateY(0) rotate(2deg); }
    .roadmap-item.active[data-phase="2"] { transform: translateY(0) rotate(-3deg); }
    .roadmap-item.active[data-phase="3"] { transform: translateY(0) rotate(1deg); }
    .roadmap-item.active[data-phase="4"] { transform: translateY(0) rotate(-2deg); }
    .roadmap-item h3 { font-size: 1.75rem; margin-bottom: 0.75rem; }
    .roadmap-item p { font-size: 1.1rem; }
    .doodle-canvas {
      border: 2px solid #2b2b2b;
      border-radius: 8px;
      background: #ffffff;
      box-shadow: 4px 4px 8px rgba(0, 0, 0, 0.15);
      margin: 1rem auto;
      display: block;
      width: 100%;
      max-width: 512px;
    }
    .control-group {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      margin: 0.5rem;
      padding: 0.5rem;
      border: 2px solid #2b2b2b;
      border-radius: 5px;
      background: #fff;
    }
    .fade-in {
      opacity: 0;
      transform: translateY(20px);
      transition: all 0.6s ease-out;
    }
    .fade-in.visible {
      opacity: 1;
      transform: translateY(0);
    }
    nav {
      background: #fffef0;
      border-bottom: 2px solid #2b2b2b;
      position: sticky;
      top: 0;
      z-index: 100;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      padding: 0.5rem 1rem;
    }
    .nav-menu {
      display: flex;
      justify-content: center;
      gap: 1.5rem;
      padding: 0.75rem 0;
    }
    .nav-menu a {
      color: #2b2b2b;
      font-family: 'Comic Neue', cursive;
      font-weight: 700;
      text-decoration: none;
      position: relative;
      padding: 0.25rem 0.5rem;
    }
    .nav-menu a::after {
      content: '';
      position: absolute;
      bottom: -2px;
      left: 0;
      width: 0;
      height: 2px;
      background: #ffeb3b;
      transition: width 0.3s;
    }
    .nav-menu a:hover::after { width: 100%; }
    .hamburger {
      display: none;
      cursor: pointer;
      font-size: 1.5rem;
      padding: 0.5rem;
    }
    #nav-toggle { display: none; }
    .text-red-500 {
      color: #ef4444;
    }
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(0, 0, 0, 0.8);
      z-index: 10000;
      margin: 0;
      padding: 0;
      overflow: auto;
    }
    .modal-content {
      background: #fffef0;
      border: 3px solid #2b2b2b;
      border-radius: 0;
      width: 100%;
      min-height: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      margin: 0;
      padding: 1rem;
      box-sizing: border-box;
      overflow-y: auto;
    }
    .close-modal {
      position: fixed;
      top: 10px;
      right: 10px;
      font-size: 1.5rem;
      cursor: pointer;
      color: #2b2b2b;
      z-index: 10001;
    }
    .tools-drawer {
      position: fixed;
      bottom: 0;
      left: 0;
      width: 100%;
      background: #fffef0;
      border-top: 3px solid #2b2b2b;
      padding: 1rem;
      transform: translateY(100%);
      transition: transform 0.3s ease-in-out;
      z-index: 10002;
      box-shadow: 0 -4px 8px rgba(0, 0, 0, 0.15);
    }
    .tools-drawer.active {
      transform: translateY(0);
    }
    .drawer-toggle {
      position: fixed;
      bottom: 10px;
      right: 10px;
      z-index: 10003;
      background: #ffeb3b;
      border: 2px solid #2b2b2b;
      border-radius: 50%;
      width: 50px;
      height: 50px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      box-shadow: 4px 4px 8px rgba(0, 0, 0, 0.15);
      transition: transform 0.2s;
    }
    .drawer-toggle:hover {
      transform: scale(1.1);
    }
    #openCanvasButton {
      display: none;
    }
    @media (max-width: 1024px) {
      .paper-panel { max-width: 100%; padding: 1.25rem; }
      .nav-menu { gap: 1rem; }
      .doodle-img { max-height: 250px; }
      .roadmap-container { min-height: 70vh; padding-top: 60px; }
      .roadmap-item { width: 95%; }
      .roadmap-item.active { top: 60px; }
    }
    @media (max-width: 768px) {
      .hamburger { display: block; }
      .nav-menu {
        display: none;
        flex-direction: column;
        position: absolute;
        top: 100%;
        left: 0;
        width: 100%;
        background: #fffef0;
        border-top: 2px solid #2b2b2b;
        padding: 1rem;
      }
      #nav-toggle:checked ~ .nav-menu { display: flex; }
      .doodle-img { max-height: 200px; }
      .paper-panel { margin: 0.75rem; padding: 1rem; }
      .doodle-button { padding: 0.5rem 1rem; font-size: 0.9rem; }
      .roadmap-container { min-height: 60vh; }
      .roadmap-item h3 { font-size: 1.5rem; }
      .roadmap-item p { font-size: 1rem; }
      .control-group { flex-wrap: wrap; justify-content: center; }
      .doodle-canvas { max-width: 90%; }
      #doodleContainer { display: none; }
      #drawingTools { display: none; }
      #openCanvasButton { display: block; margin: 1rem auto; }
    }
    @media (max-width: 480px) {
      h1 { font-size: 2rem; }
      h2 { font-size: 1.75rem; }
      h3 { font-size: 1.25rem; }
      .doodle-img { max-height: 150px; }
      .paper-panel { margin: 0.5rem; padding: 0.75rem; }
      .doodle-button { padding: 0.4rem 0.8rem; font-size: 0.8rem; }
      .contract { font-size: 0.8rem; max-width: 100%; }
      .roadmap-item { padding: 1rem; }
      .doodle-canvas { max-width: 100%; height: auto; }
      .control-group { margin: 0.3rem; padding: 0.4rem; }
      .tools-drawer { padding: 0.75rem; }
      .drawer-toggle { width: 40px; height: 40px; }
    }
  </style>
</head>
<body>
  <nav>
    <input type="checkbox" id="nav-toggle" class="hidden">
    <label for="nav-toggle" class="hamburger">☰</label>
    <div class="nav-menu">
      <a href="#home"><i class="fas fa-home mr-1"></i>Home</a>
      <a href="#about"><i class="fas fa-info-circle mr-1"></i>About</a>
      <a href="#roadmap"><i class="fas fa-map mr-1"></i>Roadmap</a>
      <a href="#memes"><i class="fas fa-laugh mr-1"></i>Memes</a>
      <a href="#gallery"><i class="fas fa-image mr-1"></i>Gallery</a>
      <a href="#community"><i class="fas fa-users mr-1"></i>Community</a>
    </div>
  </nav>

  <section id="home" class="paper-panel fade-in">
    <h1 class="text-5xl text-center mb-6">Blu $Bul!</h1>
    <p class="text-center text-lg mb-6">Hop into the wild $BUL memecoin adventure on Sui!</p>
    <img src="/main.jpg" alt="Blu Bul Doodle" class="doodle-img mx-auto mb-6">
    <p class="text-center text-lg mb-6">Grab your pencil and ride the $BUL wave! 🐂 27% token locked! 🔒</p>
    <div class="flex justify-center space-x-4 mb-6 flex-wrap gap-2">
      <a href="https://raidenx.io/sui/moonbags-bul-sui-260025" target="_blank" class="doodle-button"><i class="fas fa-shopping-cart"></i>Buy $BUL</a>
      <a href="https://moonbags.io/bondingcurve/coins/0x1e23e826d80ba22b5c754ddc371a0a0c4b914b8ca77a6eb697c619a5ce8ddf48::bul::BUL" target="_blank" class="doodle-button"><i class="fas fa-rocket"></i>Moonbags</a>
    </div>
    <div class="text-center mb-6">
      <p class="font-bold">Contract Doodle:</p>
      <div class="contract">0x1e23e826d80ba22b5c754ddc371a0a0c4b914b8ca77a6eb697c619a5ce8ddf48::bul::BUL</div>
      <button onclick="navigator.clipboard.writeText('0x1e23e826d80ba22b5c754ddc371a0a0c4b914b8ca77a6eb697c619a5ce8ddf48::bul::BUL'); alert('Scribbled to your clipboard!')" class="doodle-button mt-4"><i class="fas fa-copy"></i>Copy It!</button>
    </div>
  </section>

  <section id="about" class="paper-panel fade-in">
    <h2 class="text-4xl text-center mb-6">How to Join the Doodle Herd</h2>
    <ol class="list-decimal list-inside text-center text-lg mb-6">
      <li>Snag some SUI from Binance or KuCoin.</li>
      <li>Sketch out a Sui wallet (try Slush Wallet).</li>
      <li>Send SUI to your wallet doodle.</li>
      <li>Connect to RaidenX, paste the $BUL contract, and draw some $BUL!</li>
    </ol>
  </section>

  <section id="roadmap" class="paper-panel fade-in">
    <h2 class="text-4xl text-center mb-6">Doodle Roadmap</h2>
    <p class="text-center text-lg mb-6">Our scribbled path to the moon!</p>
    <div class="roadmap-container">
      <div class="roadmap-item" data-phase="1">
        <h3 class="text-2xl font-bold mb-2">Phase 1: Launch $BUL</h3>
        <p>Drop $BUL on the Sui blockchain with a wild doodle party!</p>
      </div>
      <div class="roadmap-item" data-phase="2">
        <h3 class="text-2xl font-bold mb-2">Phase 2: Community Vibes</h3>
        <p>Grow the herd with epic doodle contests and memes.</p>
      </div>
      <div class="roadmap-item" data-phase="3">
        <h3 class="text-2xl font-bold mb-2">Phase 3: Dex Listing!</h3>
        <p>List $BUL on major Sui-based decentralized exchanges.</p>
      </div>
      <div class="roadmap-item" data-phase="4">
        <h3 class="text-2xl font-bold mb-2">Phase 4: Expansion</h3>
        <p>Onboard artists, devs, and fans to build more doodle magic.</p>
      </div>
      <div class="roadmap-item" data-phase="5">
        <h3 class="text-2xl font-bold mb-2">Phase 5: Exchange Listings</h3>
        <p>Get $BUL on major exchanges for max doodle power!</p>
      </div>
    </div>
  </section>

  <section id="memes" class="paper-panel fade-in">
    <h2 class="text-4xl text-center mb-6" style="color: #ff3366; text-shadow: 2px 2px 0 #2b2b2b, 3px 3px 0 #33ccff;">Meme Doodle Zone</h2>
    <p class="text-center text-lg mb-6" style="color: #00cc99; font-family: 'Gochi Hand', cursive;">Draw your $BUL doodle and Generate!</p>
    <div class="text-center mb-6 flex flex-wrap justify-center gap-2" id="drawingTools">
      <div class="control-group">
        <i class="fas fa-paint-brush text-[#ff3366]"></i>
        <label for="drawColor" class="text-sm">Stroke Color:</label>
        <input type="color" id="drawColor" class="color-picker" value="#ff3366">
      </div>
      <div class="control-group">
        <i class="fas fa-fill-drip text-[#ff3366]"></i>
        <label for="fillColor" class="text-sm">Fill Color:</label>
        <input type="color" id="fillColor" class="color-picker" value="#ffffff">
      </div>
      <div class="control-group">
        <i class="fas fa-toggle-on text-[#ff3366]"></i>
        <label for="fillToggle" class="text-sm">Fill Background:</label>
        <input type="checkbox" id="fillToggle" class="mt-2">
      </div>
      <div class="control-group">
        <i class="fas fa-ruler text-[#ff3366]"></i>
        <label for="brushSize" class="text-sm">Brush Size:</label>
        <input type="range" id="brushSize" class="brush-size" min="1" max="20" value="3">
      </div>
      <div class="control-group">
        <i class="fas fa-spray-can text-[#ff3366]"></i>
        <label for="brushType" class="text-sm">Brush Type:</label>
        <select id="brushType" class="brush-type">
          <option value="standard">Standard</option>
          <option value="spray">Spray Paint</option>
          <option value="eraser">Eraser</option>
        </select>
      </div>
      <div class="control-group">
        <i class="fas fa-undo text-[#ff3366]"></i>
        <button id="undoCanvas" class="doodle-button">Undo</button>
      </div>
      <div class="control-group">
        <i class="fas fa-eraser text-[#ff3366]"></i>
        <button id="clearCanvas" class="doodle-button">Clear Sketch</button>
      </div>
      <div class="control-group">
        <i class="fas fa-magic text-[#ff3366]"></i>
        <button id="generateDoodle" class="doodle-button">Generate!</button>
      </div>
    </div>
    <button id="openCanvasButton" class="doodle-button"><i class="fas fa-paint-brush"></i>Open Canvas</button>
    <div id="doodleContainer"></div>
    <div class="paper-panel fade-in mt-6" id="previewSection">
      <h3 class="text-2xl text-center mb-4">Enhanced Doodle Preview</h3>
      <p class="text-center text-lg mb-4">Check out your enhanced doodle below!</p>
      <div class="text-center mb-6 flex flex-wrap justify-center gap-2">
        <div class="control-group">
          <i class="fas fa-sliders-h text-[#ff3366]"></i>
          <label for="sharpenLevel" class="text-sm">Sharpen:</label>
          <input type="range" id="sharpenLevel" min="0" max="2" step="0.1" value="1">
        </div>
        <div class="control-group">
          <i class="fas fa-sun text-[#ff3366]"></i>
          <label for="brightnessLevel" class="text-sm">Brightness:</label>
          <input type="range" id="brightnessLevel" min="-50" max="50" value="10">
        </div>
        <div class="control-group">
          <i class="fas fa-adjust text-[#ff3366]"></i>
          <label for="contrastLevel" class="text-sm">Contrast:</label>
          <input type="range" id="contrastLevel" min="0.5" max="2" step="0.1" value="1.2">
        </div>
        <div class="control-group">
          <i class="fas fa-palette text-[#ff3366]"></i>
          <label for="saturationLevel" class="text-sm">Saturation:</label>
          <input type="range" id="saturationLevel" min="0" max="2" step="0.1" value="1.3">
        </div>
        <div class="control-group">
          <i class="fas fa-star text-[#ff3366]"></i>
          <label for="glowToggle" class="text-sm">Doodle Glow:</label>
          <input type="checkbox" id="glowToggle" class="mt-2" checked>
        </div>
        <div class="control-group">
          <i class="fas fa-dice text-[#ff3366]"></i>
          <button id="randomEnhance" class="doodle-button">Random Enhance</button>
        </div>
      </div>
      <div class="flex justify-center relative">
        <img id="enhancedImage" src="" alt="Enhanced Doodle" class="doodle-canvas hidden" style="max-width: 60%; max-height: 500px;">
        <div id="loadingSpinner" class="hidden absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2">
          <p class="text-[#ff3366] font-bold">Enhancing Doodle...</p>
        </div>
      </div>
      <div class="flex justify-center space-x-4 mt-4 flex-wrap gap-2">
        <button id="downloadPreview" class="doodle-button"><i class="fas fa-download"></i>Download Doodle</button>
      </div>
      <p id="errorMessage" class="text-red-500 text-center mt-2"></p>
    </div>
  </section>

  <section id="gallery" class="paper-panel fade-in px-4 py-8">
    <h2 class="text-4xl text-center mb-6">Doodle Gallery</h2>
    <p class="text-center text-lg mb-6">Check out our sick Blu Bul sketches!</p>
    <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
      <div class="border-4 border-dashed border-[#ff3366] bg-[#fffef0] rounded-lg p-4 text-center shadow-[4px_4px_8px_rgba(0,0,0,0.15)] transition-transform hover:scale-105 hover:rotate-2">
        <img src="/meme1.png" alt="Art 1" class="w-full h-auto border-2 border-[#33ccff] rounded-lg rotate-1">
        <p>Sketch #1</p>
      </div>
      <div class="border-4 border-dashed border-[#ff3366] bg-[#fffef0] rounded-lg p-4 text-center shadow-[4px_4px_8px_rgba(0,0,0,0.15)] transition-transform hover:scale-105 hover:rotate-2">
        <img src="/meme2.png" alt="Art 2" class="w-full h-auto border-2 border-[#33ccff] rounded-lg rotate-1">
        <p>Sketch #2</p>
      </div>
      <div class="border-4 border-dashed border-[#ff3366] bg-[#fffef0] rounded-lg p-4 text-center shadow-[4px_4px_8px_rgba(0,0,0,0.15)] transition-transform hover:scale-105 hover:rotate-2">
        <img src="/meme3.png" alt="Art 3" class="w-full h-auto border-2 border-[#33ccff] rounded-lg rotate-1">
        <p>Sketch #3</p>
      </div>
      <div class="border-4 border-dashed border-[#ff3366] bg-[#fffef0] rounded-lg p-4 text-center shadow-[4px_4px_8px_rgba(0,0,0,0.15)] transition-transform hover:scale-105 hover:rotate-2">
        <img src="/meme4.png" alt="Art 4" class="w-full h-auto border-2 border-[#33ccff] rounded-lg rotate-1">
        <p>Sketch #4</p>
      </div>
    </div>
  </section>

  <section id="community" class="paper-panel fade-in">
    <h2 class="text-4xl text-center mb-6">Join the Doodle Gang</h2>
    <p class="text-center text-lg mb-6">Hang with the Blu Bul crew!</p>
    <div class="flex justify-center space-x-4 mb-6 flex-wrap gap-2">
      <a href="https://t.me/+_EaH2D1QjmAwYmVk" target="_blank" class="doodle-button"><i class="fab fa-telegram-plane"></i>Join Telegram</a>
      <a href="https://x.com/SuiBluBull" target="_blank" class="doodle-button"><i class="fab fa-x-twitter"></i>Follow on X</a>
    </div>
  </section>

  <footer class="paper-panel text-center">
    <p class="text-lg">© 2025 Blu Bul. Scribbled with 💪 and crayons!</p>
  </footer>

  <div id="canvasModal" class="modal">
    <div class="modal-content">
      <span class="close-modal">×</span>
      <div id="modalCanvasContainer"></div>
      <div class="tools-drawer" id="toolsDrawer">
        <div class="text-center mb-6 flex flex-wrap justify-center gap-2">
          <div class="control-group">
            <i class="fas fa-paint-brush text-[#ff3366]"></i>
            <label for="modalDrawColor" class="text-sm">Stroke Color:</label>
            <input type="color" id="modalDrawColor" class="color-picker" value="#ff3366">
          </div>
          <div class="control-group">
            <i class="fas fa-fill-drip text-[#ff3366]"></i>
            <label for="modalFillColor" class="text-sm">Fill Color:</label>
            <input type="color" id="modalFillColor" class="color-picker" value="#ffffff">
          </div>
          <div class="control-group">
            <i class="fas fa-toggle-on text-[#ff3366]"></i>
            <label for="modalFillToggle" class="text-sm">Fill Background:</label>
            <input type="checkbox" id="modalFillToggle" class="mt-2">
          </div>
          <div class="control-group">
            <i class="fas fa-ruler text-[#ff3366]"></i>
            <label for="modalBrushSize" class="text-sm">Brush Size:</label>
            <input type="range" id="modalBrushSize" class="brush-size" min="1" max="20" value="3">
          </div>
          <div class="control-group">
            <i class="fas fa-spray-can text-[#ff3366]"></i>
            <label for="modalBrushType" class="text-sm">Brush Type:</label>
            <select id="modalBrushType" class="brush-type">
              <option value="standard">Standard</option>
              <option value="spray">Spray Paint</option>
              <option value="eraser">Eraser</option>
            </select>
          </div>
          <div class="control-group">
            <i class="fas fa-undo text-[#ff3366]"></i>
            <button id="modalUndoCanvas" class="doodle-button">Undo</button>
          </div>
          <div class="control-group">
            <i class="fas fa-eraser text-[#ff3366]"></i>
            <button id="modalClearCanvas" class="doodle-button">Clear Sketch</button>
          </div>
          <div class="control-group">
            <i class="fas fa-magic text-[#ff3366]"></i>
            <button id="modalGenerateDoodle" class="doodle-button">Generate!</button>
          </div>
        </div>
      </div>
      <div class="drawer-toggle" id="drawerToggle">
        <i class="fas fa-tools text-[#2b2b2b]"></i>
      </div>
    </div>
  </div>

  <script>
  let userCanvas = null;
  let drawHistory = [];
  let p5Instance = null;

  window.addEventListener('load', () => {
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add('visible');
        }
      });
    }, { threshold: 0.1 });

    document.querySelectorAll('.fade-in').forEach(el => observer.observe(el));

    const roadmapSection = document.querySelector('#roadmap');
    const roadmapItems = document.querySelectorAll('.roadmap-item');
    const totalPhases = roadmapItems.length;
    let lastScrollTop = 0;
    let isProgrammaticScroll = false;

    const updateRoadmap = () => {
      const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
      const roadmapRect = roadmapSection.getBoundingClientRect();
      const isScrollingDown = scrollTop > lastScrollTop;

      if (roadmapRect.top < window.innerHeight && roadmapRect.bottom > 0) {
        const sectionHeight = roadmapSection.offsetHeight;
        const scrollWithinSection = Math.max(0, window.innerHeight - roadmapRect.top);
        const scrollProgress = scrollWithinSection / (sectionHeight + window.innerHeight);
        let phaseIndex = Math.floor(scrollProgress * totalPhases) % totalPhases;

        if (phaseIndex < 0) phaseIndex += totalPhases;

        roadmapItems.forEach((item, index) => {
          const isActive = index === phaseIndex;
          item.classList.toggle('active', isActive);
          item.style.opacity = isActive ? 1 : 0;
          item.style.transform = isActive
            ? `translateY(0) rotate(${item.dataset.phase === '1' ? '2deg' : item.dataset.phase === '2' ? '-3deg' : item.dataset.phase === '3' ? '1deg' : item.dataset.phase === '4' ? '-2deg' : '0deg'}) scale(1)`
            : `translateY(50px) rotate(${item.dataset.phase === '1' ? '2deg' : item.dataset.phase === '2' ? '-3deg' : item.dataset.phase === '3' ? '1deg' : item.dataset.phase === '4' ? '-2deg' : '0deg'}) scale(0.95)`;
        });

        if (isScrollingDown && scrollProgress >= 1) {
          isProgrammaticScroll = true;
          window.scrollTo({
            top: roadmapSection.offsetTop,
            behavior: 'instant'
          });
        } else if (!isScrollingDown && scrollProgress <= 0 && roadmapRect.top >= 0) {
          isProgrammaticScroll = true;
          window.scrollTo({
            top: roadmapSection.offsetTop + sectionHeight - window.innerHeight,
            behavior: 'instant'
          });
        }
      }

      if (!isProgrammaticScroll) {
        lastScrollTop = scrollTop;
      }
      isProgrammaticScroll = false;
    };

    let scrollTimeout;
    window.addEventListener('scroll', () => {
      clearTimeout(scrollTimeout);
      scrollTimeout = setTimeout(updateRoadmap, 10);
    });

    updateRoadmap();

    const openCanvasButton = document.getElementById('openCanvasButton');
    const canvasModal = document.getElementById('canvasModal');
    const closeModal = document.querySelector('.close-modal');
    const drawerToggle = document.getElementById('drawerToggle');
    const toolsDrawer = document.getElementById('toolsDrawer');
    const isMobile = window.innerWidth <= 768;

    if (isMobile) {
      openCanvasButton.style.display = 'block';
      document.getElementById('doodleContainer').style.display = 'none';
      document.getElementById('drawingTools').style.display = 'none';
    } else {
      openCanvasButton.style.display = 'none';
      document.getElementById('doodleContainer').style.display = 'block';
      document.getElementById('drawingTools').style.display = 'flex';
    }

    drawerToggle.addEventListener('click', () => {
      toolsDrawer.classList.toggle('active');
    });

    const drawingSketch = (p) => {
      let isDrawing = false;
      let currentColor = '#ff3366';
      let fillColor = '#ffffff';
      let brushSize = 3;
      let brushType = 'standard';
      let fillBackground = false;
      let startX, startY;
      let currentPath = [];

      p.setup = () => {
        userCanvas = p.createCanvas(512, 512);
        userCanvas.class('doodle-canvas');
        userCanvas.parent(isMobile ? 'modalCanvasContainer' : 'doodleContainer');
        p.background(fillBackground ? fillColor : 255);
        p.strokeWeight(brushSize);
        p.stroke(currentColor);
        p.noFill();
        drawHistory = [{ type: 'clear', color: fillBackground ? fillColor : 255 }];
      };

      p.draw = () => {
        if (isDrawing && p.mouseX >= 0 && p.mouseX < p.width && p.mouseY >= 0 && p.mouseY < p.height) {
          if (brushType === 'standard') {
            p.line(p.pmouseX, p.pmouseY, p.mouseX, p.mouseY);
            currentPath.push({ x: p.mouseX, y: p.mouseY });
          } else if (brushType === 'spray') {
            for (let i = 0; i < 10; i++) {
              let offsetX = p.random(-brushSize, brushSize);
              let offsetY = p.random(-brushSize, brushSize);
              p.point(p.mouseX + offsetX, p.mouseY + offsetY);
              currentPath.push({ x: p.mouseX + offsetX, y: p.mouseY + offsetY, spray: true });
            }
          } else if (brushType === 'eraser') {
            p.stroke(fillBackground ? fillColor : 255);
            p.line(p.pmouseX, p.pmouseY, p.mouseX, p.mouseY);
            currentPath.push({ x: p.mouseX, y: p.mouseY });
            p.stroke(currentColor);
          }
        }
      };

      p.mousePressed = () => {
        if (p.mouseX >= 0 && p.mouseX < p.width && p.mouseY >= 0 && p.mouseY < p.height) {
          isDrawing = true;
          startX = p.mouseX;
          startY = p.mouseY;
          p.stroke(currentColor);
          p.strokeWeight(brushSize);
          p.noFill();
          if (brushType === 'eraser') {
            p.stroke(fillBackground ? fillColor : 255);
            p.strokeWeight(brushSize * 2);
          }
          currentPath = [{ x: startX, y: startY }];
          drawHistory.push({
            type: brushType,
            color: currentColor,
            size: brushSize,
            path: currentPath,
            bg: fillBackground ? fillColor : 255
          });
        }
      };

      p.mouseReleased = () => {
        isDrawing = false;
        currentPath = [];
      };

      const redrawCanvas = () => {
        p.background(drawHistory[0].color);
        drawHistory.forEach(action => {
          if (action.type === 'clear') {
            p.background(action.color);
          } else {
            p.stroke(action.color);
            p.strokeWeight(action.size);
            if (action.type === 'eraser') {
              p.stroke(action.bg);
              p.strokeWeight(action.size * 2);
            }
            for (let i = 1; i < action.path.length; i++) {
              if (!action.path[i].spray) {
                p.line(action.path[i - 1].x, action.path[i - 1].y, action.path[i].x, action.path[i].y);
              } else {
                p.point(action.path[i].x, action.path[i].y);
              }
            }
          }
        });
        p.stroke(currentColor);
        p.strokeWeight(brushSize);
        p.noFill();
      };

      const setupEventListeners = (prefix) => {
        document.getElementById(`${prefix}DrawColor`).addEventListener('input', (e) => {
          currentColor = e.target.value;
          p.stroke(currentColor);
        });

        document.getElementById(`${prefix}FillColor`).addEventListener('input', (e) => {
          fillColor = e.target.value;
          if (fillBackground) {
            p.background(fillColor);
            drawHistory[0].color = fillColor;
            drawHistory.forEach(action => {
              if (action.type === 'eraser') action.bg = fillColor;
            });
            redrawCanvas();
          }
        });

        document.getElementById(`${prefix}FillToggle`).addEventListener('change', (e) => {
          fillBackground = e.target.checked;
          p.background(fillBackground ? fillColor : 255);
          drawHistory[0].color = fillBackground ? fillColor : 255;
          drawHistory.forEach(action => {
            if (action.type === 'eraser') action.bg = fillBackground ? fillColor : 255;
          });
          redrawCanvas();
        });

        document.getElementById(`${prefix}BrushSize`).addEventListener('input', (e) => {
          brushSize = parseInt(e.target.value);
          p.strokeWeight(brushSize);
          if (brushType === 'eraser') p.strokeWeight(brushSize * 2);
        });

        document.getElementById(`${prefix}BrushType`).addEventListener('change', (e) => {
          brushType = e.target.value;
          if (brushType === 'eraser') {
            p.stroke(fillBackground ? fillColor : 255);
            p.strokeWeight(brushSize * 2);
          } else {
            p.stroke(currentColor);
            p.strokeWeight(brushSize);
          }
        });

        document.getElementById(`${prefix}ClearCanvas`).addEventListener('click', () => {
          p.background(fillBackground ? fillColor : 255);
          drawHistory = [{ type: 'clear', color: fillBackground ? fillColor : 255 }];
        });

        document.getElementById(`${prefix}UndoCanvas`).addEventListener('click', () => {
          if (drawHistory.length > 1) {
            drawHistory.pop();
            redrawCanvas();
          }
        });
      };

      if (isMobile) {
        setupEventListeners('modal');
      } else {
        setupEventListeners('');
      }
    };

    const initCanvas = () => {
      if (p5Instance) {
        p5Instance.remove();
      }
      try {
        p5Instance = new p5(drawingSketch);
      } catch (e) {
        console.error('Error initializing sketch:', e);
        document.getElementById('errorMessage').textContent = 'Failed to initialize drawing: ' + e.message;
      }
    };

    openCanvasButton.addEventListener('click', () => {
      canvasModal.style.display = 'block';
      if (isMobile && !userCanvas) {
        initCanvas();
      }
    });

    closeModal.addEventListener('click', () => {
      canvasModal.style.display = 'none';
      toolsDrawer.classList.remove('active');
    });

    if (!isMobile) {
      initCanvas();
    }

    function enhanceDoodle(canvas, isRandom) {
      const tempCanvas = document.createElement('canvas');
      tempCanvas.width = canvas.width;
      tempCanvas.height = canvas.height;
      const ctx = tempCanvas.getContext('2d');
      ctx.drawImage(canvas, 0, 0);

      const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
      const data = imageData.data;

      let sharpenLevel, brightnessLevel, contrastLevel, saturationLevel, glowToggle;
      if (isRandom) {
        sharpenLevel = Math.random() * 2;
        brightnessLevel = Math.random() * 100 - 50;
        contrastLevel = Math.random() * 1.5 + 0.5;
        saturationLevel = Math.random() * 2;
        glowToggle = Math.random() > 0.5;
      } else {
        sharpenLevel = parseFloat(document.getElementById('sharpenLevel').value);
        brightnessLevel = parseFloat(document.getElementById('brightnessLevel').value);
        contrastLevel = parseFloat(document.getElementById('contrastLevel').value);
        saturationLevel = parseFloat(document.getElementById('saturationLevel').value);
        glowToggle = document.getElementById('glowToggle').checked;
      }

      const sharpenKernel = [
        0, -1, 0,
        -1, 5, -1,
        0, -1, 0
      ];
      const weight = sharpenLevel ? 1 / sharpenLevel : 1;
      let newData = new Uint8ClampedArray(data.length);

      for (let y = 1; y < canvas.height - 1; y++) {
        for (let x = 1; x < canvas.width - 1; x++) {
          const idx = (y * canvas.width + x) * 4;
          let r = 0, g = 0, b = 0;

          for (let ky = -1; ky <= 1; ky++) {
            for (let kx = -1; kx <= 1; kx++) {
              const kIdx = (ky + 1) * 3 + (kx + 1);
              const pixelIdx = ((y + ky) * canvas.width + (x + kx)) * 4;
              r += data[pixelIdx] * sharpenKernel[kIdx] * sharpenLevel;
              g += data[pixelIdx + 1] * sharpenKernel[kIdx] * sharpenLevel;
              b += data[pixelIdx + 2] * sharpenKernel[kIdx] * sharpenLevel;
            }
          }

          newData[idx] = Math.min(255, Math.max(0, r / weight));
          newData[idx + 1] = Math.min(255, Math.max(0, g / weight));
          newData[idx + 2] = Math.min(255, Math.max(0, b / weight));
          newData[idx + 3] = data[idx + 3];
        }
      }

      for (let i = 0; i < newData.length; i += 4) {
        newData[i] = Math.min(255, Math.max(0, newData[i] + brightnessLevel));
        newData[i + 1] = Math.min(255, Math.max(0, newData[i + 1] + brightnessLevel));
        newData[i + 2] = Math.min(255, Math.max(0, newData[i + 2] + brightnessLevel));
        newData[i] = Math.min(255, Math.max(0, (newData[i] - 128) * contrastLevel + 128));
        newData[i + 1] = Math.min(255, Math.max(0, (newData[i + 1] - 128) * contrastLevel + 128));
        newData[i + 2] = Math.min(255, Math.max(0, (newData[i + 2] - 128) * contrastLevel + 128));
      }

      for (let i = 0; i < newData.length; i += 4) {
        const r = newData[i];
        const g = newData[i + 1];
        const b = newData[i + 2];
        const gray = 0.2989 * r + 0.5870 * g + 0.1140 * b;
        newData[i] = Math.min(255, Math.max(0, gray + (r - gray) * saturationLevel));
        newData[i + 1] = Math.min(255, Math.max(0, gray + (g - gray) * saturationLevel));
        newData[i + 2] = Math.min(255, Math.max(0, gray + (b - gray) * saturationLevel));
      }

      const finalData = new Uint8ClampedArray(newData.length);
      for (let y = 1; y < canvas.height - 1; y++) {
        for (let x = 1; x < canvas.width - 1; x++) {
          const idx = (y * canvas.width + x) * 4;
          const left = ((y * canvas.width + (x - 1)) * 4);
          const right = ((y * canvas.width + (x + 1)) * 4);
          const up = (((y - 1) * canvas.width + x) * 4);
          const down = (((y + 1) * canvas.width + x) * 4);

          const edge = Math.abs(newData[left] - newData[right]) +
                       Math.abs(newData[up] - newData[down]) > 50 ? 1 : 0;

          if (glowToggle && edge && newData[idx + 3] > 0) {
            finalData[idx] = 255;
            finalData[idx + 1] = 51;
            finalData[idx + 2] = 102;
            finalData[idx + 3] = 200;
          } else if (edge && newData[idx + 3] > 0) {
            finalData[idx] = 43;
            finalData[idx + 1] = 43;
            finalData[idx + 2] = 43;
            finalData[idx + 3] = 255;
          } else {
            finalData[idx] = newData[idx];
            finalData[idx + 1] = newData[idx + 1];
            finalData[idx + 2] = newData[idx + 2];
            finalData[idx + 3] = newData[idx + 3];
          }
        }
      }

      const enhancedImageData = new ImageData(finalData, canvas.width, canvas.height);
      ctx.putImageData(enhancedImageData, 0, 0);
      return tempCanvas.toDataURL('image/png');
    }

    const generateDoodle = () => {
      const enhanceButton = isMobile ? document.getElementById('modalGenerateDoodle') : document.getElementById('generateDoodle');
      const originalText = enhanceButton.innerHTML;
      enhanceButton.disabled = true;
      enhanceButton.innerHTML = '<i class="fas fa-magic text-[#ff3366]"></i> Enhancing...';
      const loadingSpinner = document.getElementById('loadingSpinner');
      const enhancedImage = document.getElementById('enhancedImage');
      const errorMessage = document.getElementById('errorMessage');
      const canvasModal = document.getElementById('canvasModal');

      loadingSpinner.classList.remove('hidden');
      enhancedImage.classList.add('hidden');
      errorMessage.textContent = '';

      try {
        const canvasElement = userCanvas.elt;
        if (!canvasElement) {
          throw new Error('Canvas not found');
        }
        const enhancedDataUrl = enhanceDoodle(canvasElement, false);
        enhancedImage.src = enhancedDataUrl;
        enhancedImage.classList.remove('hidden');
        canvasModal.style.display = 'none';
        if (isMobile) {
          toolsDrawer.classList.remove('active');
        }
      } catch (err) {
        console.error('Enhance error:', err.message);
        errorMessage.textContent = `Error: ${err.message}`;
      } finally {
        loadingSpinner.classList.add('hidden');
        enhanceButton.disabled = false;
        enhanceButton.innerHTML = originalText;
      }
    };

    if (isMobile) {
      document.getElementById('modalGenerateDoodle').addEventListener('click', generateDoodle);
    } else {
      document.getElementById('generateDoodle').addEventListener('click', generateDoodle);
    }

    document.getElementById('randomEnhance').addEventListener('click', () => {
      const randomButton = document.getElementById('randomEnhance');
      const originalText = randomButton.innerHTML;
      randomButton.disabled = true;
      randomButton.innerHTML = '<i class="fas fa-dice text-[#ff3366]"></i> Randomizing...';
      const loadingSpinner = document.getElementById('loadingSpinner');
      const enhancedImage = document.getElementById('enhancedImage');
      const errorMessage = document.getElementById('errorMessage');

      loadingSpinner.classList.remove('hidden');
      enhancedImage.classList.add('hidden');
      errorMessage.textContent = '';

      try {
        const canvasElement = userCanvas.elt;
        if (!canvasElement) {
          throw new Error('Canvas not found');
        }
        const enhancedDataUrl = enhanceDoodle(canvasElement, true);
        enhancedImage.src = enhancedDataUrl;
        enhancedImage.classList.remove('hidden');
      } catch (err) {
        console.error('Enhance error:', err.message);
        errorMessage.textContent = `Error: ${err.message}`;
      } finally {
        loadingSpinner.classList.add('hidden');
        randomButton.disabled = false;
        randomButton.innerHTML = originalText;
      }
    });

    document.getElementById('downloadPreview').addEventListener('click', () => {
      const enhancedImage = document.getElementById('enhancedImage');
      if (enhancedImage.src && !enhancedImage.classList.contains('hidden')) {
        const link = document.createElement('a');
        link.download = 'blu-bul-enhanced-doodle.png';
        link.href = enhancedImage.src;
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
      } else {
        alert('No enhanced doodle available to download!');
      }
    });
  });
  </script>
</body>
</html>